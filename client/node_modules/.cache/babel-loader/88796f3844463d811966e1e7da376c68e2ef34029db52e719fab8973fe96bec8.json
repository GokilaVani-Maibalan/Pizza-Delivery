{"ast":null,"code":"import { loadScript } from \"../utils/loadScript\";\nimport { API_ENDPOINT } from \"../utils/api\";\nimport axios from \"axios\";\nimport { toast } from \"react-toastify\";\nexport const payActions = (token, price) => async dispatch => {\n  dispatch({\n    type: \"RAZORPAY_REQUEST\"\n  });\n  const config = {\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  };\n  const res = await loadScript(\"https://checkout.razorpay.com/v1/checkout.js\");\n  let rpInstance;\n  try {\n    rpInstance = await axios.post(`${API_ENDPOINT}/orders/pay`, {\n      amount: price\n    }, config);\n  } catch (err) {\n    toast.error(err.response.data.message);\n    dispatch({\n      type: \"RAZORPAY_REQUEST_FAILED\"\n    });\n  }\n  if (!res || !rpInstance) {\n    toast.error(\"Error contacting payment gateway, try again!\");\n    dispatch({\n      type: \"RAZORPAY_REQUEST_FAILED\"\n    });\n  }\n  dispatch({\n    type: \"RAZORPAY_REQUEST_SUCCESS\",\n    payload: rpInstance.data.order\n  });\n  dispatch({\n    type: \"RAZORPAY_REQUEST_COMPLETE\"\n  });\n};\nexport const verifyPaymentAction = (token, order, rpData) => dispatch => {\n  dispatch({\n    type: \"PAYMENT_VERIFICATION_REQUEST\"\n  });\n  const config = {\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  };\n  axios.post(`${API_ENDPOINT}/orders/verify`, {\n    order,\n    rpData\n  }, config).then(data => {\n    toast.success(\"Payment Success\");\n    dispatch({\n      type: \"PAYMENT_VERIFICATION_SUCCESS\"\n    });\n  }).catch(err => {\n    toast.error(err.response.data.message);\n    dispatch({\n      type: \"PAYMENT_VERIFICATION_FAILED\"\n    });\n  });\n};","map":{"version":3,"names":["loadScript","API_ENDPOINT","axios","toast","payActions","token","price","dispatch","type","config","headers","Authorization","res","rpInstance","post","amount","err","error","response","data","message","payload","order","verifyPaymentAction","rpData","then","success","catch"],"sources":["C:/Users/suren/Desktop/Pizza-Delivery/frontend/src/actions/payActions.js"],"sourcesContent":["import { loadScript } from \"../utils/loadScript\";\r\nimport { API_ENDPOINT } from \"../utils/api\";\r\nimport axios from \"axios\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nexport const payActions = (token, price) => async (dispatch) => {\r\n  dispatch({\r\n    type: \"RAZORPAY_REQUEST\",\r\n  });\r\n  const config = {\r\n    headers: {\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n  };\r\n  const res = await loadScript(\"https://checkout.razorpay.com/v1/checkout.js\");\r\n  let rpInstance;\r\n  try {\r\n    rpInstance = await axios.post(\r\n      `${API_ENDPOINT}/orders/pay`,\r\n      {\r\n        amount: price,\r\n      },\r\n      config\r\n    );\r\n  } catch (err) {\r\n    toast.error(err.response.data.message);\r\n    dispatch({\r\n      type: \"RAZORPAY_REQUEST_FAILED\",\r\n    });\r\n  }\r\n  if (!res || !rpInstance) {\r\n    toast.error(\"Error contacting payment gateway, try again!\");\r\n    dispatch({\r\n      type: \"RAZORPAY_REQUEST_FAILED\",\r\n    });\r\n  }\r\n  dispatch({\r\n    type: \"RAZORPAY_REQUEST_SUCCESS\",\r\n    payload: rpInstance.data.order,\r\n  });\r\n  dispatch({\r\n    type: \"RAZORPAY_REQUEST_COMPLETE\",\r\n  });\r\n};\r\n\r\nexport const verifyPaymentAction = (token, order, rpData) => (dispatch) => {\r\n  dispatch({\r\n    type: \"PAYMENT_VERIFICATION_REQUEST\",\r\n  });\r\n  const config = {\r\n    headers: {\r\n      Authorization: `Bearer ${token}`,\r\n    },\r\n  };\r\n  axios\r\n    .post(\r\n      `${API_ENDPOINT}/orders/verify`,\r\n      {\r\n        order,\r\n        rpData,\r\n      },\r\n      config\r\n    )\r\n    .then((data) => {\r\n      toast.success(\"Payment Success\");\r\n      dispatch({\r\n        type: \"PAYMENT_VERIFICATION_SUCCESS\",\r\n      });\r\n    })\r\n    .catch((err) => {\r\n      toast.error(err.response.data.message);\r\n      dispatch({\r\n        type: \"PAYMENT_VERIFICATION_FAILED\",\r\n      });\r\n    });\r\n};\r\n"],"mappings":"AAAA,SAASA,UAAU,QAAQ,qBAAqB;AAChD,SAASC,YAAY,QAAQ,cAAc;AAC3C,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,KAAK,QAAQ,gBAAgB;AAEtC,OAAO,MAAMC,UAAU,GAAGA,CAACC,KAAK,EAAEC,KAAK,KAAK,MAAOC,QAAQ,IAAK;EAC9DA,QAAQ,CAAC;IACPC,IAAI,EAAE;EACR,CAAC,CAAC;EACF,MAAMC,MAAM,GAAG;IACbC,OAAO,EAAE;MACPC,aAAa,EAAG,UAASN,KAAM;IACjC;EACF,CAAC;EACD,MAAMO,GAAG,GAAG,MAAMZ,UAAU,CAAC,8CAA8C,CAAC;EAC5E,IAAIa,UAAU;EACd,IAAI;IACFA,UAAU,GAAG,MAAMX,KAAK,CAACY,IAAI,CAC1B,GAAEb,YAAa,aAAY,EAC5B;MACEc,MAAM,EAAET;IACV,CAAC,EACDG,MACF,CAAC;EACH,CAAC,CAAC,OAAOO,GAAG,EAAE;IACZb,KAAK,CAACc,KAAK,CAACD,GAAG,CAACE,QAAQ,CAACC,IAAI,CAACC,OAAO,CAAC;IACtCb,QAAQ,CAAC;MACPC,IAAI,EAAE;IACR,CAAC,CAAC;EACJ;EACA,IAAI,CAACI,GAAG,IAAI,CAACC,UAAU,EAAE;IACvBV,KAAK,CAACc,KAAK,CAAC,8CAA8C,CAAC;IAC3DV,QAAQ,CAAC;MACPC,IAAI,EAAE;IACR,CAAC,CAAC;EACJ;EACAD,QAAQ,CAAC;IACPC,IAAI,EAAE,0BAA0B;IAChCa,OAAO,EAAER,UAAU,CAACM,IAAI,CAACG;EAC3B,CAAC,CAAC;EACFf,QAAQ,CAAC;IACPC,IAAI,EAAE;EACR,CAAC,CAAC;AACJ,CAAC;AAED,OAAO,MAAMe,mBAAmB,GAAGA,CAAClB,KAAK,EAAEiB,KAAK,EAAEE,MAAM,KAAMjB,QAAQ,IAAK;EACzEA,QAAQ,CAAC;IACPC,IAAI,EAAE;EACR,CAAC,CAAC;EACF,MAAMC,MAAM,GAAG;IACbC,OAAO,EAAE;MACPC,aAAa,EAAG,UAASN,KAAM;IACjC;EACF,CAAC;EACDH,KAAK,CACFY,IAAI,CACF,GAAEb,YAAa,gBAAe,EAC/B;IACEqB,KAAK;IACLE;EACF,CAAC,EACDf,MACF,CAAC,CACAgB,IAAI,CAAEN,IAAI,IAAK;IACdhB,KAAK,CAACuB,OAAO,CAAC,iBAAiB,CAAC;IAChCnB,QAAQ,CAAC;MACPC,IAAI,EAAE;IACR,CAAC,CAAC;EACJ,CAAC,CAAC,CACDmB,KAAK,CAAEX,GAAG,IAAK;IACdb,KAAK,CAACc,KAAK,CAACD,GAAG,CAACE,QAAQ,CAACC,IAAI,CAACC,OAAO,CAAC;IACtCb,QAAQ,CAAC;MACPC,IAAI,EAAE;IACR,CAAC,CAAC;EACJ,CAAC,CAAC;AACN,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}